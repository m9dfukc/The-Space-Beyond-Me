#include <Flash.h>

/* named arrays */
FLASH_TABLE( unsigned int, FScene_1, 3,
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400}
);

FLASH_TABLE( unsigned int, FScene_2, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400}
);

FLASH_TABLE( unsigned int, FScene_3, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455}
);

FLASH_TABLE( unsigned int, FScene_4, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400},
  {4000, 2000, 333},
  {2550, 300, 2555},
  {100, 2002, 400}
);

FLASH_TABLE( unsigned int, FScene_5, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455}
);

FLASH_TABLE( unsigned int, FScene_6, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455}
  
);

FLASH_TABLE( unsigned int, FScene_7, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455}
);

FLASH_TABLE( unsigned int, FScene_8, 3,
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455},
  {2000, 4000, 3333333222},
  {6550, 3300, 24455}
);

_FLASH_TABLE<unsigned int> FScenes[] = { FScene_1, FScene_2, FScene_3, FScene_4, FScene_5, FScene_6, FScene_7, FScene_8 };
int FScene_count = sizeof(FScenes) / sizeof(_FLASH_TABLE<unsigned int>);
unsigned int test[3];
//scenes[0] = scene_1;

void setup() {
  Serial.begin(115200);  
  
  Serial.print("RAM Table: "); Serial.println(sizeof(_FLASH_TABLE<unsigned int>));
  Serial.print("RAM scenes: "); Serial.println(sizeof(FScenes));
  
  Serial.print("Mem: "); Serial.println(availableMemory());

  // Example 2: Named flash strings
  // 2.b Find the length of flash string (internally uses strlen_P)
  Serial.print("Rows s1: "); Serial.println(FScene_1.rows());
  Serial.print("RAM s1: "); Serial.println(sizeof(FScene_1));
  
  Serial.print("Rows s4: "); Serial.println(FScene_4.rows());
  Serial.print("RAM s4: "); Serial.println(sizeof(FScene_4));
  
  for(int s=0; s < FScene_count; ++s) {
   for(int i=0; i < FScenes[s].rows(); ++i) {
      _FLASH_ARRAY<unsigned int> scene = FScenes[s][i];
      
      /* seems to bug here ! */
      test[0] = scene[0];
      test[1] = scene[1];
      test[2] = scene[2];
      
      Serial.print("Scene: "); 
      Serial.print(s);
      Serial.print(", _x: ");
      Serial.print(test[0]);
      Serial.print(", _y: ");
      Serial.print(test[1]);
      Serial.print(", _z: ");
      Serial.println(test[2]);
   }
  }
}

void loop() {
}

int availableMemory() 
{
  int size = 1024;
  byte *buf;
  while ((buf = (byte *) malloc(--size)) == NULL);
  free(buf);
  return size;
}





